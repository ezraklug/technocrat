// ==== LIBRARY ==== //

// This file contains all the theme-agnostic functions and mixins that don't rely on anything else; feel free to drop it into other projects



// == MIXINS == //

// Background cover image; pass a URL or relative path wrapped in quotation marks: "http://yoursite.com/image.jpg"
// Source: http://css-tricks.com/perfect-full-page-background-image/
@mixin background-cover($path: false) {
  @if $path {
    background: url(#{$path}) no-repeat center center fixed;
    background-size: cover;
  }
}



// Center block; via Scut
@mixin center-block($max-width: false) {
  margin-left: auto;
  margin-right: auto;
  @if $max-width {
    max-width: $max-width;
  }
}



// Clearfix suite
@mixin clearfix-above {
  &:before {
    content: "";
    display: table;
    clear: both;
  }
}
@mixin clearfix-below {
  &:after {
    content: "";
    display: table;
    clear: both;
  }
}
@mixin clearfix {
  @include clearfix-above;
  @include clearfix-below;
}
@mixin clearfix-reset($target: both) {
  @if $target == both {
    &:before {
      display: none;
    }
    &:after {
      display: none;
    }
  }
  @if $target == above {
    &:before {
      display: none;
    }
  }
  @if $target == below {
    &:after {
      display: none;
    }
  }
}



// Dashicons mixin for use with WordPress dashicon font; defaults to :before
@mixin dashicon($content, $dir: before) {
  &:#{$dir} {
    font-family: "dashicons";
    content: "#{$content}";
  }
}



// Ghosting; use on any element to obscure it from view except on hover
@mixin ghost($value: .666) {
  opacity: $value;
  transition: opacity .5s ease;
  &:hover {
    opacity: 1;
    transition: opacity .2s ease-in;
  }
}



// Hanging indent; via Scut
@mixin hanging-indent($indent: 1em) {
  padding-left: $indent;
  text-indent: -$indent;
}



// Hide visually; via Scut
@mixin hide-visually {
  border: 0;
  clip: rect(0 0 0 0);
  height: 1px;
  margin: -1px;
  overflow: hidden;
  padding: 0;
  position: absolute;
  width: 1px;
}



// Floated list; $space inserts a space between items, $dir specifies the direction of the float
@mixin list-floated($space: false, $direction: left) {
  @include clearfix;
  list-style-type: none;
  margin: 0;
  padding: 0;
  & > li {
    float: $direction;
    @if $space {
      margin-#{opposite($direction)}: $space;
    }
  }
  @if $space {
    & > li:last-of-type {
      margin-#{opposite($direction)}: 0;
    }
  }
}



// Nested list in dropdown style; adapted from http://garethcooper.com/2013/05/sass-menu/
@mixin list-nested {

  // Everything is relative
  & > li {
    position: relative;
  }

  // Make primary submenus drop down
  ul {
    opacity: 0;
    position: absolute;
      left: 0;
      top: 100%;
    transition: opacity .2s ease-out;
    visibility: hidden;
    z-index: 999;

    // Causes list items and links to fill the space
    li {
      display: block;
      margin: 0;
      width: 100%;
      a {
        display: block;
      }
    }
  }

  // Make secondary submenus appear to the right
  ul ul {
    left: 100%;
    top: 0;
  }

  // Show submenus on hover
  li:hover > ul {
    opacity: 1;
    transition: opacity .09s ease-in;
    visibility: visible;
  }

  // Don't display menu items nested more than three deep
  ul ul ul li:hover ul {
    display: none;
  }
}



// Master media query mixin; only for use with screens, of course; should work with raw integers or pixel values
@mixin media-query($min-query: null, $max-query: null) {
  @if $min-query == null and $max-query == null {
    @warn "Mixin media-query() received two null values; no output."
  }
  @else if $max-query == null {
    @media screen and (min-width: $min-query+0px) { @content; }
  }
  @else if $min-query == null {
    @media screen and (max-width: $max-query+0px) { @content; }
  }
  @else {
    @media screen and (min-width: $min-query+0px) and (max-width: $max-query+0px) { @content; }
  }
}

// Media query shortcuts
@mixin media-above($query) {
  @include media-query($query, null) { @content; }
}
@mixin media-below($query) {
  @include media-query(null, $query) { @content; }
}
@mixin media-between($min-query: null, $max-query: null) {
  @if $min-query == null or $max-query == null {
    @warn "Mixin media-between() received a null value."
  }
  @include media-query($min-query, $max-query) { @content; }
}



// To reverse reverse italics :3
@mixin regular-italics($elements: null) {
  $element-list: em, cite, i;
  @each $el in $elements {
    $element-list: append($element-list, unquote($el), comma)
  }
  font-style: normal;
  #{$element-list} {
    font-style: italic;
  }
}



// Reverse italics; via Scut
@mixin reverse-italics($elements: null) {
  $element-list: em, cite, i;
  @each $el in $elements {
    $element-list: append($element-list, unquote($el), comma)
  }
  font-style: italic;
  #{$element-list} {
    font-style: normal;
  }
}



// Truncate text; via http://web-design-weekly.com/2013/05/12/handy-sass-mixins/
@mixin text-truncate {
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}



// Pseudo triangle; specify $size in pixels; adapted from https://github.com/catalinred/Animenu/
@mixin triangle($size: 6px, $direction: top, $offset: $size, $offset-direction: left, $parent-width: 180px) {
  &:after {
    border: $size solid transparent;
    border-bottom-color: inherit;
    content: '';
    position: absolute;
      @if $offset == "center" {
        #{$offset-direction}: 50% - percentage( $size / $parent-width );
      } @else {
        #{$offset-direction}: $offset;
      }
      #{$direction}: -$size * 2;
  }
}



// == FUNCTIONS == //

// Direction rotation: use opposite, clockwise, or counterclockwise (or shorthand functions below); adapted from http://www.sitepoint.com/sass-mixins-kickstart-project/
@function rotate($direction, $dimension: "opposite") {
  @if not index(top right bottom left, $direction) {
    @warn "Direction must be one of `top`, `right`, `bottom` or `left`; currently `#{$direction}`.";
  } @else {
    @if not index(opposite clockwise counterclockwise, $dimension) {
      @warn "Dimension must be one of `opposite`, `clockwise`, `counterclockwise`; currently `#{$dimension}`.";
    }
    $map: ();
    @if $dimension == "opposite" {
      $map: (
        'top':    'bottom',
        'right':  'left',
        'bottom': 'top',
        'left':   'right'
      );
    }
    @if $dimension == "clockwise" {
      $map: (
        'top':    'right',
        'right':  'bottom',
        'bottom': 'left',
        'left':   'top'
      );
    }
    @if $dimension == "counterclockwise" {
      $map: (
        'top':    'left',
        'right':  'top',
        'bottom': 'right',
        'left':   'bottom'
      );
    }
    $direction: map-get($map, $direction);
  }
  @return $direction;
}
@function opposite($direction) {
  @return rotate($direction, "opposite");
}
@function clockwise($direction) {
  @return rotate($direction, "clockwise");
}
@function counterclockwise($direction) {
  @return rotate($direction, "counterclockwise");
}



// Strip units from any value; via http://hugogiraudel.com/2013/08/12/sass-functions/
@function strip-unit($value) {
  @return $value / ($value * 0 + 1);
}



// Base64 encoded pixels
@function pixel($pixel: transparent) {
  @if $pixel == black {
    @return "data:image/gif;base64,R0lGODlhAQABAIAAAAUEBAAAACwAAAAAAQABAAACAkQBADs=";
  }
  @if $pixel == transparent {
    @return "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7";
    //data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==
  }
  @if $pixel == white {
    @return "data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACwAAAAAAQABAAACAkQBADs=";
  }
}

@function pixel-black() {
  @return pixel(black);
}
@function pixel-transparent() {
  @return pixel(transparent);
}
@function pixel-white() {
  @return pixel(white);
}



// == DEVELOPMENT == //

// A few untested mixins and functions via Sacha Greif: http://sachagreif.com/useful-sass-mixins/
@function black($opacity: 1) {
  @return rgba(0, 0, 0, $opacity);
}
@function white($opacity: 1) {
  @return rgba(255, 255, 255, $opacity);
}

// Box emboss
@mixin box-emboss($opacity: 0.75, $opacity2: 0.75) {
  box-shadow: white($opacity) 0 1px 0, inset black($opacity2) 0 1px 0;
}

// Letterpress
@mixin letterpress($opacity) {
  text-shadow: white($opacity) 0 1px 0;
}