// ==== VIEWS ==== //

// == GALLERY VIEW == //

.gallery-view {
  // Assumes `float: left` is set elsewhere

  // Responsive gallery view; not especially DRY but it has the advantage of being targetted and precise; no wasted CSS here
  // Won't produce neat 30px margins between images on Firefox because of cross-browser scrollbar inconsistencies; not important enough to fix with JavaScript hackery

  // Custom breakpoints specifically for gallery view
  // Note there will be some minor quirks due to slight differences between these custom breakpoints and those of the rest of the site's interface

  $b-gallery-small: 300 + spacer(); // Below this it's a single column layout
  $b-gallery-medium: 600 + $spacer-image + spacer(2); // Upper threshold for the two column layout; $spacer-image accounts for the inner margin
  @include k-media-below( $b-gallery-small ) {
    .gallery figure.wp-caption {
      @include rem( margin, 0 0 $spacer-image 0 ); // Only a bottom margin is needed
      max-width: 100%;
    }
  }
  @include k-media-between( $b-gallery-small, $b-gallery-medium ) {
    $margin-width: $spacer-image / 600px;
    .gallery figure.wp-caption {
      margin: 0 percentage( $margin-width ) percentage( $margin-width ) 0;
      max-width: percentage( 1 / 2 ) - percentage( $margin-width / 2 );
      &:nth-of-type(2n) {
        margin-right: 0;
      }
      &:nth-of-type(2n+1) {
        clear: left;
      }
    }
  }
  @include k-media-above( $b-gallery-medium ) {
    .gallery figure.wp-caption {

      // The following calculations based on content width presume that gallery view is always full-width (which it should be)
      margin: 0 percentage( $spacer-image / $width-content ) percentage( $spacer-image / $width-content ) 0;
      max-width: percentage( 1 / 3 ) - percentage( ( ( $spacer-image * 2 ) / $width-content ) / 3 );
      &:nth-of-type(3n) {
        margin-right: 0;
      }
      &:nth-of-type(3n+1) {
        clear: left;
      }
    }
  }
}



// == LIST VIEW == //

// Whereas the gallery view styling is used throughout Pendrell the list view section is exclusive to the views module
@if module(views) {

  // This class only appears in list-view so it is safe to declare it without nesting
  .entry-thumbnail {
    float: left;
    width: 150px;
    figure.wp-caption {
      @extend %spacer-reset;
      figcaption {
        background-image: none; // Reset; no text here, all we want is the hover effect
      }
    }
  }

  // This section is messy and disorganized mainly to prevent unnecessary nesting
  .list-view {
    .entry-title {
      @include font-size(head);
      margin: 0;
    }
    .site-content article {
      @extend %spacer-below;
      @extend %text-small;
    }

    // Entry meta
    .entry-meta {
      @extend %clearfix-reset;
      @include font-size(text-smallest);
      color: colour(text-lightest);
      text-transform: uppercase;
    }

    // Entry content (with more below for full-width styling)
    .entry-content-wrapper {
      margin-left: $width-thumb + spacer();
    }
    .entry-content p {
      @extend %text-small;
      @extend %spacer-reset;
    }

    // Link post format
    .entry-link {
      @extend %hide;
    }

    // Full-width modifications
    &.full-width {
      @include k-media-above( break(large) ) {
        .entry-title {
          @include font-size(head);
        }
        .entry-content p {
          @include font-size(text);
        }
      }
    }
  }

  // Reset a few things when a list appears within a post or page
  .entry-content .list-view article {
    @extend %spacer-below;
    a,
    a:visited {
      border-bottom: none;
    }
    p {
      @extend %spacer-reset;
    }
  }
}
